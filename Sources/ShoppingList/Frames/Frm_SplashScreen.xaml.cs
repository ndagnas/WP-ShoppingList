//*******************************************************************************************************************************
// DEBUT DU FICHIER
//*******************************************************************************************************************************

//*******************************************************************************************************************************
// Nom           : Frm_SplashScreen.xaml.cs
// Auteur        : Nicolas Dagnas
// Description   : Implémentation du formulaire Frm_SplashScreen
// Créé le       : 27/10/2013
// Modifié le    : 09/06/2014
//*******************************************************************************************************************************

//-------------------------------------------------------------------------------------------------------------------------------
#region Using directives
//-------------------------------------------------------------------------------------------------------------------------------
using System;
using System.Windows;
using System.ComponentModel;
using System.Windows.Threading;
//~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
using Microsoft.Phone.Shell;
using Microsoft.Phone.Controls;
//~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
using ShoppingList.Resources;
//-------------------------------------------------------------------------------------------------------------------------------
#endregion
//-------------------------------------------------------------------------------------------------------------------------------

//*******************************************************************************************************************************
// Début du bloc "ShoppingList.Frames"
//*******************************************************************************************************************************
namespace ShoppingList.Frames
	{

	//   ####  ####   #       ###    ####  #   #          ####   ###   ####   #####  #####  #   #
	//  #      #   #  #      #   #  #      #   #         #      #   #  #   #  #      #      ##  #
	//   ###   ####   #      #####   ###   #####  #####   ###   #      ####   ###    ###    # # #
	//      #  #      #      #   #      #  #   #             #  #   #  #   #  #      #      #  ##
	//  ####   #      #####  #   #  ####   #   #         ####    ###   #   #  #####  #####  #   #

	//***************************************************************************************************************************
	#region // Frame Frm_SplashScreen
	//---------------------------------------------------------------------------------------------------------------------------
	/// <summary>
	/// Définit le fond de la fenêtre de chargement de l'application.
	/// </summary>
	//---------------------------------------------------------------------------------------------------------------------------
	public partial class Frm_SplashScreen : PhoneApplicationPage
		{
		//***********************************************************************************************************************
		#region // Section des Constructeurs
		//-----------------------------------------------------------------------------------------------------------------------

		//***********************************************************************************************************************
		/// <summary>
		/// Initialise une nouvelle instance de l'objet <b>Frm_SplashScreen</b>.
		/// </summary>
		//-----------------------------------------------------------------------------------------------------------------------
		public Frm_SplashScreen ()
			{
			//-------------------------------------------------------------------------------------------------------------------
			this.InitializeComponent ();

			this.VersionControl.Text = string.Format ( AppResources.SplashScreenForm_Version_Label, 
			                                            VersionUtils.Current.Major, 
										                VersionUtils.Current.Minor, 
										                VersionUtils.Current.Build );
			//-------------------------------------------------------------------------------------------------------------------
			}
		//***********************************************************************************************************************
		
		//-----------------------------------------------------------------------------------------------------------------------
		#endregion
		//***********************************************************************************************************************

		//***********************************************************************************************************************
		#region // Section des Evenements liés aux Contrôles
		//-----------------------------------------------------------------------------------------------------------------------

		//***********************************************************************************************************************
		/// <summary>
		/// Se produit à la fin de l'animation de l'image.
		/// </summary>
		/// <param name="Sender">Objet source de l'appel.</param>
		/// <param name="Args"><b>EventArgs</b> qui contient les données d'événement.</param>
		//-----------------------------------------------------------------------------------------------------------------------
		private void SplashScreenAnimation_Completed ( object Sender, EventArgs Args )
			{
			//-------------------------------------------------------------------------------------------------------------------
			this.Dispatcher.BeginInvoke ( new Action ( () =>
				{
				//---------------------------------------------------------------------------------------------------------------
				this.LoadControl   .Visibility = Visibility.Visible;
				this.VersionControl.Visibility = Visibility.Visible;
				//---------------------------------------------------------------------------------------------------------------

				//---------------------------------------------------------------------------------------------------------------
				this.Dispatcher.Async ( () =>
					{
					//-----------------------------------------------------------------------------------------------------------
					try
						{
						//-------------------------------------------------------------------------------------------------------
						this.NavigationService.Navigate ( new Uri ( "/Frames/Frm_Home.xaml"   , 
																			  UriKind.Relative ) );
						//-------------------------------------------------------------------------------------------------------
						}
					//-----------------------------------------------------------------------------------------------------------
					catch
						{
						//-------------------------------------------------------------------------------------------------------
						try
							{
							//---------------------------------------------------------------------------------------------------
							if ( this.NavigationService.CanGoBack )
								this.NavigationService.GoBack ();
							//---------------------------------------------------------------------------------------------------
							}
						//-------------------------------------------------------------------------------------------------------
						catch {}
						//-------------------------------------------------------------------------------------------------------
						}
					//-----------------------------------------------------------------------------------------------------------
					}, 1000 );
				//---------------------------------------------------------------------------------------------------------------
				} ) );
			//-------------------------------------------------------------------------------------------------------------------
			}
		//***********************************************************************************************************************
		
		//-----------------------------------------------------------------------------------------------------------------------
		#endregion
		//***********************************************************************************************************************
		}
	//---------------------------------------------------------------------------------------------------------------------------
	#endregion
	//***************************************************************************************************************************

	} // Fin du namespace "ShoppingList.Frames"
//*******************************************************************************************************************************

//*******************************************************************************************************************************
// FIN DU FICHIER
//*******************************************************************************************************************************
