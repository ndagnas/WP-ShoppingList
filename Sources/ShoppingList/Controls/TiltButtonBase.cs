//*******************************************************************************************************************************
// DEBUT DU FICHIER
//*******************************************************************************************************************************

//*******************************************************************************************************************************
// Nom           : TiltButtonBase.cs
// Auteur        : Nicolas Dagnas
// Description   : Implémentation du contrôle GroupBlock
// Créé le       : 02/06/2013
// Modifié le    : 09/01/2014
//*******************************************************************************************************************************

//-------------------------------------------------------------------------------------------------------------------------------
#region Using directives
//-------------------------------------------------------------------------------------------------------------------------------
using System;
using System.Windows;
using System.Windows.Threading;
using System.Windows.Controls.Primitives;
//-------------------------------------------------------------------------------------------------------------------------------
#endregion
//-------------------------------------------------------------------------------------------------------------------------------

//*******************************************************************************************************************************
// Début du bloc "ShoppingList.Controls"
//*******************************************************************************************************************************
namespace ShoppingList.Controls
	{

	//  #####  #  #      #####         ####   #####  #   #         ####    ###    ####  #####
	//    #    #  #        #           #   #    #    ##  #         #   #  #   #  #      #    
	//    #    #  #        #    #####  ####     #    # # #  #####  ####   #####   ###   ###  
	//    #    #  #        #           #   #    #    #  ##         #   #  #   #      #  #    
	//    #    #  #####    #           ####     #    #   #         ####   #   #  ####   #####

	//***************************************************************************************************************************
	// Classe TiltButtonBase
	//***************************************************************************************************************************
	#region // Déclaration et Implémentation de l'Objet
	//---------------------------------------------------------------------------------------------------------------------------
	/// <summary>
	/// Fournit un champ groupe.
	/// </summary>
	//---------------------------------------------------------------------------------------------------------------------------
	public class TiltButtonBase : ButtonBase
		{
		//-----------------------------------------------------------------------------------------------------------------------
		// Section des Constantes
		//-----------------------------------------------------------------------------------------------------------------------
		private const int TiltEffectDuration = 200;
		//-----------------------------------------------------------------------------------------------------------------------

		//-----------------------------------------------------------------------------------------------------------------------
		// Section des Attributs
		//-----------------------------------------------------------------------------------------------------------------------
		public static readonly DependencyProperty DurationEffectProperty;
		//-----------------------------------------------------------------------------------------------------------------------

		//***********************************************************************************************************************
		#region // Section des Constructeurs
		//-----------------------------------------------------------------------------------------------------------------------
		
		//***********************************************************************************************************************
		/// <summary>
		/// Constructeur statique de l'objet <b>TiltButtonBase</b>.
		/// </summary>
		//-----------------------------------------------------------------------------------------------------------------------
		static TiltButtonBase ()
			{
			//-------------------------------------------------------------------------------------------------------------------
			DurationEffectProperty = DependencyProperty.Register ( "DurationEffect", 
				typeof (bool), typeof (TiltButtonBase), new PropertyMetadata ( true ) );
			//-------------------------------------------------------------------------------------------------------------------
			}
		//***********************************************************************************************************************

		//***********************************************************************************************************************
		/// <summary>
		/// Initialise une nouvelle instance de l'objet <b>TiltButtonBase</b>.
		/// </summary>
		//-----------------------------------------------------------------------------------------------------------------------
		public TiltButtonBase () { base.DefaultStyleKey = typeof (TiltButtonBase); }
		//***********************************************************************************************************************

		//-----------------------------------------------------------------------------------------------------------------------
		#endregion
		//***********************************************************************************************************************

		//***********************************************************************************************************************
		#region // Section des Procédures
		//-----------------------------------------------------------------------------------------------------------------------

		//***********************************************************************************************************************
		/// <summary>
		/// Se produit lors d'un clic sur le bouton.
		/// </summary>
		//-----------------------------------------------------------------------------------------------------------------------
		protected override void OnClick ()
			{
			//-------------------------------------------------------------------------------------------------------------------
			if ( this.DurationEffect )
				{
				this.Dispatcher.Async ( () => { base.OnClick (); }, TiltEffectDuration );
				}
			else { base.OnClick (); }
			//-------------------------------------------------------------------------------------------------------------------
			}
		//***********************************************************************************************************************

		//-----------------------------------------------------------------------------------------------------------------------
		#endregion
		//***********************************************************************************************************************

		//***********************************************************************************************************************
		/// <summary>
		/// Indique s'il faut attendre entre le click visuel et le click réel.
		/// </summary>
		//-----------------------------------------------------------------------------------------------------------------------
		public bool DurationEffect
			{
			//-------------------------------------------------------------------------------------------------------------------
			get { return (bool)base.GetValue ( DurationEffectProperty ); }
			//-------------------------------------------------------------------------------------------------------------------
			set { base.SetValue ( DurationEffectProperty, value ); }
			//-------------------------------------------------------------------------------------------------------------------
			}
		//***********************************************************************************************************************
		}
	//---------------------------------------------------------------------------------------------------------------------------
	#endregion
	//***************************************************************************************************************************

	} // Fin du namespace "ShoppingList.Controls"
//*******************************************************************************************************************************

//*******************************************************************************************************************************
// FIN DU FICHIER
//*******************************************************************************************************************************
